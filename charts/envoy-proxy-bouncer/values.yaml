replicaCount: 1 # @schema default: 1

image:
  repository: ghcr.io/kdwils/envoy-proxy-bouncer # @schema default: "ghcr.io/kdwils/envoy-proxy-bouncer"
  pullPolicy: IfNotPresent # @schema default: "IfNotPresent"
  tag: "" # @schema default: ".Chart.AppVersion"

imagePullSecrets: []
nameOverride: "" # @schema default: ""
fullnameOverride: "" # @schema default: ""

serviceAccount:
  create: true # @schema default: true
  name: "" # @schema default: ""

podSecurityContext: {}

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - all
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

service:
  type: ClusterIP # @schema default: ClusterIP
  grpcPort: 8080 # @schema default: 8080
  httpPort: 8081 # @schema default: 8081

resources:
  limits:
    cpu: 100m
    memory: 128Mi

config:
  server:
    grpcPort: 8080 # @schema default: 8080
    httpPort: 8081 # @schema default: 8081
    logLevel: "info" # @schema default: "info"

  trustedProxies: [] # @schema default: []

  bouncer:
    enabled: true # @schema default: true
    metrics: false # @schema default: false
    metricsInterval: "10m" # @schema default: "10m"
    lapiURL: "http://crowdsec-service:8080" # @schema default: "http://crowdsec-service:8080"
    tickerInterval: "10s" # @schema default: "10s"
    apiKey: "" # @schema default: ""
    apiKeySecretRef: # @schema type: object
      name: "" # @schema default: ""
      key: "" # @schema default: ""

  waf:
    enabled: false # @schema default: false
    appSecURL: "http://crowdsec-appsec-service:7422" # @schema default: "http://crowdsec-appsec-service:7422"
    apiKey: "" # @schema default: ""
    apiKeySecretRef: # @schema type: object
      name: "" # @schema default: ""
      key: "" # @schema default: ""

  captcha:
    enabled: false # @schema default: false
    provider: "" # @schema default: ""
    siteKey: "" # @schema default: ""
    secretKey: "" # @schema default: ""
    secretKeySecretRef: # @schema type: object
      name: "" # @schema default: ""
      key: "" # @schema default: ""
    signingKey: "" # @schema default: ""
    signingKeySecretRef: # @schema type: object
      name: "" # @schema default: ""
      key: "" # @schema default: ""
    timeout: "10s" # @schema default: "10s"
    challengeDuration: "5m" # @schema default: "5m"
    sessionDuration: "15m" # @schema default: "15m"
    callbackURL: "" # @schema default: ""
    cookieDomain: "" # @schema default: ""
    cookieName: "" # @schema default: ""
    secureCookie: true # @schema default: true

  templates:
    deniedTemplatePath: "" # @schema default: ""
    deniedTemplateHeaders: "" # @schema default: ""
    captchaTemplatePath: "" # @schema default: ""
    captchaTemplateHeaders: "" # @schema default: ""

probes:
  liveness:
    enabled: true # @schema default: true
    initialDelaySeconds: 5 # @schema default: 5
    periodSeconds: 5 # @schema default: 5
    timeoutSeconds: 5 # @schema default: 5
    failureThreshold: 3 # @schema default: 3
  readiness:
    enabled: true # @schema default: true
    initialDelaySeconds: 5 # @schema default: 5
    periodSeconds: 5 # @schema default: 5
    timeoutSeconds: 5 # @schema default: 5
    failureThreshold: 3 # @schema default: 3

autoscaling:
  enabled: false # @schema default: false
  minReplicas: 1 # @schema default: 1
  maxReplicas: 10 # @schema default: 10
  targetCPUUtilizationPercentage: 80 # @schema default: 80
  targetMemoryUtilizationPercentage: 80 # @schema default: 80

httproute:
  enabled: false # @schema default: false
  annotations: {} # @schema default: {}
  parentRefs: [] # @schema default: []
  hostnames: [] # @schema default: []

referenceGrant:
  create: false # @schema default: false
  fromNamespaces: [] # @schema default: []

templates:
  deniedTemplateContent: "" # @schema default: ""
  captchaTemplateContent: "" # @schema default: ""
